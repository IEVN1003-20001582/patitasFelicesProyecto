
            <!-- =================================================================
                 PÁGINA DE GESTIÓN DE MASCOTAS (CONTENIDO VET)
            ================================================================== -->
            <main class="flex-1 p-6 md:p-8 overflow-y-auto">
                
                <!-- KPIs (¡NUEVO!) -->
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-2xl shadow-lg flex items-center">
                        <div class="p-3 bg-secondary-teal rounded-full">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 14s-8-4.5-8-8a8 8 0 1116 0c0 3.5-8 8-8 8z" /><path stroke-linecap="round" stroke-linejoin="round" d="M12 14l-4 4m4-4l4 4" /></svg>
                        </div>
                        <div class="ml-4">
                            <p class="text-gray-500">Total de Pacientes</p>
                            <p class="text-2xl font-bold text-primary-dark">215</p>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-lg flex items-center">
                        <div class="p-3 bg-secondary-teal rounded-full">
                           <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>
                        </div>
                        <div class="ml-4">
                            <p class="text-gray-500">Mis Pacientes de Hoy</p>
                            <p class="text-2xl font-bold text-primary-dark">8</p>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-lg flex items-center">
                        <div class="p-3 bg-light-red rounded-full">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>
                        </div>
                        <div class="ml-4">
                            <p class="text-gray-500">Pacientes con Alergias</p>
                            <p class="text-2xl font-bold text-light-red">12</p>
                        </div>
                    </div>
                </div>

                <!-- Barra de Herramientas -->
                <div class="flex justify-between items-center mb-6">
                    <div class="relative w-full max-w-md">
                        <input type="text" placeholder="Buscar mascota por nombre o duenio..." class="w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary-teal">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                    </div>
                    <div class="flex space-x-4">
                        <button id="btn-filtros-avanzados" class="bg-white text-gray-700 border border-gray-300 font-semibold py-2 px-4 rounded-lg text-sm hover:bg-gray-50 transition duration-300 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM7 11a1 1 0 011-1h8a1 1 0 011 1v2a1 1 0 01-1 1H8a1 1 0 01-1-1v-2zM11 18a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1h-2a1 1 0 01-1-1v-2z" /></svg>
                            Filtros
                        </button>
                         <button id="btn-agregar-mascota" class="bg-secondary-teal text-white font-semibold py-2 px-5 rounded-lg text-sm shadow-md hover:bg-opacity-80 transition duration-300 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" /></svg>
                            Agregar Mascota
                        </button>
                    </div>
                </div>

                <!-- Rejilla (Grid) de Tarjetas de Mascotas (Con Alertas y Foto) -->
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                    
                    <!-- Tarjeta 1 (Con Alerta Roja) -->
                    <div class="btn-detalle-mascota bg-white rounded-2xl shadow-lg overflow-hidden transform hover:-translate-y-1 hover:shadow-xl transition duration-300 cursor-pointer">
                        <div class="h-40 bg-gray-200">
                            <img src="https://placehold.co/400x300/F4D03F/ffffff?text=Max&font=poppins" alt="Foto de Max" class="h-full w-full object-cover">
                        </div>
                        <div class="p-5">
                            <h3 class="text-xl font-bold text-primary-dark truncate">Max</h3>
                            <p class="text-gray-600 text-sm">Perro - Golden Retriever</p>
                            
                            <div class="my-3">
                                <span class="px-3 py-1 text-xs font-bold text-red-800 bg-red-200 rounded-full animate-pulse">¡ALERGIAS!</span>
                            </div>
                            
                            <div class="space-y-2 text-sm text-gray-500">
                                <div class="flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
                                    Duenio: Ana Gomez
                                </div>
                                <div class="flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2 text-secondary-teal" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 14l-7 7m0 0l-7-7m7 7V3" /></svg>
                                    Últ. Trat: Vacuna (Dr. Salas)
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tarjeta 2 (Con Alerta Amarilla) -->
                    <div class="btn-detalle-mascota bg-white rounded-2xl shadow-lg overflow-hidden transform hover:-translate-y-1 hover:shadow-xl transition duration-300 cursor-pointer">
                        <div class="h-40 bg-gray-200">
                             <img src="https://placehold.co/400x300/2C3E50/ffffff?text=Mishi&font=poppins" alt="Foto de Mishi" class="h-full w-full object-cover">
                        </div>
                        <div class="p-5">
                            <h3 class="text-xl font-bold text-primary-dark truncate">Mishi</h3>
                            <p class="text-gray-600 text-sm">Gato - Doméstico</p>
                            <div class="my-3">
                                <span class="px-3 py-1 text-xs font-semibold text-yellow-800 bg-yellow-200 rounded-full">MEDICACIÓN CRÓNICA</span>
                            </div>
                            <div class="space-y-2 text-sm text-gray-500">
                                <div class="flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
                                    Duenio: Carlos Ruiz
                                </div>
                                <div class="flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2 text-secondary-teal" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 14l-7 7m0 0l-7-7m7 7V3" /></svg>
                                    Últ. Trat: Consulta (Dr. Israel)
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tarjeta 3 (Sin Alerta) -->
                    <div class="btn-detalle-mascota bg-white rounded-2xl shadow-lg overflow-hidden transform hover:-translate-y-1 hover:shadow-xl transition duration-300 cursor-pointer">
                        <div class="h-40 bg-gray-200">
                             <img src="https://placehold.co/400x300/48C9B0/ffffff?text=Thor&font=poppins" alt="Foto de Thor" class="h-full w-full object-cover">
                        </div>
                        <div class="p-5">
                            <h3 class="text-xl font-bold text-primary-dark truncate">Thor</h3>
                            <p class="text-gray-600 text-sm">Perro - Labrador</p>
                            <div class="my-3">
                                <span class="px-3 py-1 text-xs font-semibold text-gray-700 bg-gray-100 rounded-full">Sin Alertas</span>
                            </div>
                            <div class="space-y-2 text-sm text-gray-500">
                                <div class="flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
                                    Duenio: Maria Lopez
                                </div>
                                <div class="flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2 text-secondary-teal" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 14l-7 7m0 0l-7-7m7 7V3" /></svg>
                                    Últ. Trat: Consulta (Dr. Salas)
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </main>

    <!-- =================================================================
         MODALS (Pop-ups)
    ================================================================== -->

    <!-- Modal 1: Agregar Mascota (El que faltaba) -->
    <div id="modal-agregar-mascota" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
        <!-- Contenedor del Modal -->
        <div class="bg-white rounded-2xl shadow-xl w-full max-w-2xl">
            <!-- Header del Modal -->
            <div class="flex justify-between items-center p-5 border-b">
                <h3 class="text-xl font-bold text-primary-dark">Registrar Nueva Mascota</h3>
                <button id="btn-close-agregar-mascota" class="text-gray-400 hover:text-gray-600">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            
            <!-- Cuerpo del Modal -->
            <div class="p-6 max-h-[70vh] overflow-y-auto">
                <form id="form-registrar-mascota" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <!-- Columna de Foto -->
                        <div class="md:col-span-1 flex flex-col items-center">
                            <label class="block text-gray-700 mb-2 font-semibold">Foto de la Mascota</label>
                            <div class="w-32 h-32 rounded-full bg-gray-200 flex items-center justify-center mb-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l-1.586-1.586a2 2 0 00-2.828 0L6 14m6-6l.25-.25a2 2 0 012.828 0l.25.25m-3 3l.25.25a2 2 0 002.828 0l.25-.25m-3-3l.25-.25a2 2 0 012.828 0l.25.25m0 0l-3 3m0 0l-3-3m3 3V3" /></svg>
                            </div>
                            <input type="file" id="mascota-foto" class="text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-secondary-teal file:text-white hover:file:bg-opacity-80"/>
                        </div>
                        
                        <!-- Columna de Campos Principales -->
                        <div class="md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="md:col-span-2">
                                <label for="mascota-nombre" class="block text-gray-700 mb-1 font-semibold">Nombre de la Mascota</label>
                                <input id="mascota-nombre" type="text" placeholder="Ej. Max" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary-teal" required>
                            </div>
                            <div class="md:col-span-2">
                                <label for="mascota-duenio" class="block text-gray-700 mb-1 font-semibold">Duenio (Cliente)</label>
                                <select id="mascota-duenio" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary-teal" required>
                                    <option value="">Buscar y seleccionar cliente...</option>
                                    <option value="1">Ana Gomez</option>
                                    <option value="2">Carlos Ruiz</option>
                                </select>
                            </div>
                            <div>
                                <label for="mascota-especie" class="block text-gray-700 mb-1 font-semibold">Especie</label>
                                <input id="mascota-especie" type="text" placeholder="Ej. Perro" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary-teal">
                            </div>
                            <div>
                                <label for="mascota-raza" class="block text-gray-700 mb-1 font-semibold">Raza</label>
                                <input id="mascota-raza" type="text" placeholder="Ej. Golden Retriever" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary-teal">
                            </div>
                            <div>
                                <label for="mascota-fecha-nac" class="block text-gray-700 mb-1 font-semibold">Fecha de Nacimiento</label>
                                <input id="mascota-fecha-nac" type="date" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary-teal">
                            </div>
                            <div>
                                <label for="mascota-sexo" class="block text-gray-700 mb-1 font-semibold">Sexo</label>
                                <select id="mascota-sexo" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary-teal">
                                    <option value="Macho">Macho</option>
                                    <option value="Hembra">Hembra</option>
                                </select>
                            </div>
                            <div>
                                <label for="mascota-peso" class="block text-gray-700 mb-1 font-semibold">Peso (kg)</label>
                                <input id="mascota-peso" type="number" step="0.1" placeholder="Ej. 5.2" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary-teal">
                            </div>
                             <div>
                                <label for="mascota-esterilizado" class="block text-gray-700 mb-1 font-semibold">Esterilizado</label>
                                <select id="mascota-esterilizado" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary-teal">
                                    <option value="Si">Sí</option>
                                    <option value="No">No</option>
                                    <option value="No Aplica">No Aplica</option>
                                </select>
                            </div>
                        </div>

                        <!-- Campo de Alergias (ancho completo) -->
                        <div class="md:col-span-3">
                            <label for="mascota-alergias" class="block text-gray-700 mb-1 font-semibold">Alergias Conocidas</label>
                            <textarea id="mascota-alergias" rows="3" placeholder="Ej. Alergia al pollo, polvo..." class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary-teal"></textarea>
                        </div>
                    </div>
                </form>
            </div>
            <!-- Footer del Modal -->
            <div class="flex justify-end p-5 border-t space-x-4">
                <button id="btn-cancel-agregar-mascota" type="button" class="bg-white text-gray-700 border border-gray-300 font-semibold py-2 px-4 rounded-lg hover:bg-gray-50 transition duration-300">
                    Cancelar
                </button>
                <button type="submit" form="form-registrar-mascota" class="bg-secondary-teal text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-opacity-80 transition duration-300">
                    Guardar Mascota
                </button>
            </div>
        </div>
    </div>

    <!-- Modal 2: Detalle de Mascota (Expediente Clínico Completo) -->
    <div id="modal-detalle-mascota" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
        <!-- Contenedor del Modal -->
        <div class="bg-white rounded-2xl shadow-xl w-full max-w-4xl">
            <!-- Header (Con Botón PDF) -->
            <div class="flex justify-between items-center p-5 border-b">
                <div class="flex items-center space-x-3">
                    <img class="h-16 w-16 rounded-full" src="https://placehold.co/80x80/F4D03F/ffffff?text=M&font=poppins" alt="Mascota">
                    <div>
                        <h3 class="text-2xl font-bold text-primary-dark">Max</h3>
                        <p class="text-gray-600">Perro - Golden Retriever</p>
                    </div>
                </div>
                <div class="flex space-x-3">
                    <button class="bg-white text-gray-700 border border-gray-300 font-semibold py-2 px-4 rounded-lg text-sm hover:bg-gray-50 transition duration-300 flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>
                        Exportar Ficha PDF
                    </button>
                    <button id="btn-close-detalle-mascota" class="text-gray-400 hover:text-gray-600">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
            </div>
            
            <!-- Tabs (4 Pestanias) -->
            <div class="border-b border-gray-200">
                <nav class="flex space-x-4 md:space-x-8 px-6 -mb-px">
                    <button id="tab-btn-info" class="tab-btn active py-4 px-1 border-b-4 text-sm font-medium">Info General</button>
                    <button id="tab-btn-historial" class="tab-btn py-4 px-1 border-b-4 text-sm font-medium text-gray-500 hover:text-gray-700">Historial Clínico</button>
                    <button id="tab-btn-vacunacion" class="tab-btn py-4 px-1 border-b-4 text-sm font-medium text-gray-500 hover:text-gray-700">Vacunación</button>
                    <button id="tab-btn-citas" class="tab-btn py-4 px-1 border-b-4 text-sm font-medium text-gray-500 hover:text-gray-700">Próximas Citas</button>
                </nav>
            </div>

            <!-- Contenido de las Pestanias -->
            <div class="p-6 max-h-[60vh] overflow-y-auto">
                
                <!-- Pestania 1: Información General -->
                <div id="tab-content-info" class="tab-content active space-y-4">
                    <div class="p-4 bg-red-100 border border-red-300 rounded-lg">
                        <h4 class="font-bold text-red-800">¡Alerta de Alergia!</h4>
                        <p class="text-sm text-red-700">Alergia al pollo.</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-x-6 gap-y-4">
                        <!-- ... (Campos de info general) ... -->
                        <div>
                            <label class="block text-sm font-medium text-gray-500">Duenio</label>
                            <p class="text-md text-gray-800">Ana Gomez</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-500">Fecha de Nacimiento</label>
                            <p class="text-md text-gray-800">10/05/2023 (2 anios)</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-500">Peso</label>
                            <p class="text-md text-gray-800">25.4 kg</p>
                        </div>
                    </div>
                    <!-- El Vet NO puede editar la info de la mascota (solo el Admin) -->
                    <!-- <button class="text-secondary-teal font-semibold text-sm hover:underline">Editar Información</button> -->
                </div>
                
                <!-- Pestania 2: Historial Clínico -->
                <div id="tab-content-historial" class="tab-content space-y-4">
                    <div class="flex justify-between items-center">
                        <h4 class="text-lg font-semibold text-primary-dark">Tratamientos Anteriores</h4>
                        <button id="btn-agregar-tratamiento" class="bg-secondary-teal text-white font-semibold py-2 px-4 rounded-lg text-sm shadow-md hover:bg-opacity-80 transition duration-300 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6m0 0v6m0-6h6m-6 0H6" /></svg>
                            Agregar Tratamiento
                        </button>
                    </div>
                    <div class="space-y-3">
                        <div class="p-4 border rounded-lg">
                            <p class="font-semibold text-gray-800">Vacunación Anual</p>
                            <span class="text-sm text-gray-500">10/11/2025 - Dr. Salas</span>
                        </div>
                    </div>
                </div>

                <!-- Pestania 3: Vacunación -->
                <div id="tab-content-vacunacion" class="tab-content space-y-4">
                     <!-- ¡BOTÓN NUEVO! -->
                    <div class="flex justify-between items-center">
                        <h4 class="text-lg font-semibold text-primary-dark">Calendario de Vacunación</h4>
                        <button id="btn-agregar-vacuna" class="bg-secondary-teal text-white font-semibold py-2 px-4 rounded-lg text-sm shadow-md hover:bg-opacity-80 transition duration-300 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6m0 0v6m0-6h6m-6 0H6" /></svg>
                            Registrar Vacuna
                        </button>
                    </div>
                    <!-- ¡TABLA AniADIDA! -->
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-2 text-left text-xs font-semibold text-gray-600 uppercase">Vacuna</th>
                                    <th class="px-4 py-2 text-left text-xs font-semibold text-gray-600 uppercase">Fecha Aplicación</th>
                                    <th class="px-4 py-2 text-left text-xs font-semibold text-gray-600 uppercase">Próxima Dosis</th>
                                    <th class="px-4 py-2 text-left text-xs font-semibold text-gray-600 uppercase">Aplicada por</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y">
                                <tr>
                                    <td class="px-4 py-3 text-sm font-medium text-gray-800">Rabia</td>
                                    <td class="px-4 py-3 text-sm text-gray-600">10/11/2025</td>
                                    <td class="px-4 py-3 text-sm font-semibold text-light-red">10/11/2026 (Pendiente)</td>
                                    <td class="px-4 py-3 text-sm text-gray-500">Dr. Salas</td>
                                </tr>
                                <tr>
                                    <td class="px-4 py-3 text-sm font-medium text-gray-800">Múltiple (PUPPY)</td>
                                    <td class="px-4 py-3 text-sm text-gray-600">10/06/2023</td>
                                    <td class="px-4 py-3 text-sm text-gray-500">N/A (Esquema completo)</td>
                                    <td class="px-4 py-3 text-sm text-gray-500">Dr. Israel</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Pestania 4: Próximas Citas -->
                <div id="tab-content-citas" class="tab-content space-y-4">
                    <h4 class="text-lg font-semibold text-primary-dark">Próximas Citas Programadas</h4>
                    <div class="p-4 border border-secondary-teal rounded-lg">
                            <div class="flex justify-between items-center mb-1">
                                <p class="font-semibold text-gray-800">Vacunación Anual</p>
                                <span class="text-sm text-gray-500">15 Nov 2025 - 10:00 AM</span>
                            </div>
                            <p class="text-sm text-gray-600">Con: <span class="font-medium">Dr. Salas</span></p>
                        </div>
                </div>
            </div>
        </div>
    </div>

    <!-- =================================================================
         ¡MODAL DIFERENTE! (Nivel 3)
    ================================================================== -->
    <!-- Modal 3: Agregar Tratamiento (¡VERSIÓN VETERINARIO!) -->
    <div id="modal-agregar-tratamiento" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 hidden z-[60]"> <!-- z-60 -->
        <!-- Contenedor del Modal -->
        <div class="bg-white rounded-2xl shadow-xl w-full max-w-lg">
            <!-- Header del Modal -->
            <div class="flex justify-between items-center p-5 border-b">
                <h3 class="text-xl font-bold text-primary-dark">Agregar Nuevo Tratamiento</h3>
                <button id="btn-close-agregar-tratamiento" class="text-gray-400 hover:text-gray-600">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            
            <!-- Cuerpo del Modal -->
            <div class="p-6">
                <form id="form-agregar-tratamiento" class="space-y-4">
                    
                    <!-- CAMBIO 1: Veterinario Auto-asignado -->
                    <div class="p-3 bg-blue-50 border border-blue-200 rounded-lg">
                        <p class="text-sm font-semibold text-blue-800">
                            <strong>Veterinario:</strong> Dr. Israel Gonzalez (Tú)
                        </p>
                    </div>

                    <!-- CAMBIO 2: Selector de Servicio -->
                    <div>
                        <label for="tratamiento-servicio" class="block text-gray-700 mb-1 font-semibold">Servicio / Tratamiento Realizado</label>
                        <select id="tratamiento-servicio" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary-teal" required>
                            <option value="">Selecciona un servicio de tu lista...</option>
                            <option value="Consulta Cardiológica">Consulta Cardiológica</option>
                            <option value="Consulta General">Consulta General</option>
                            <option value="Electrocardiograma">Electrocardiograma</option>
                        </select>
                    </div>

                    <div>
                        <label for="tratamiento-desc" class="block text-gray-700 mb-1 font-semibold">Notas del Procedimiento</label>
                        <textarea id="tratamiento-desc" rows="3" placeholder="Notas clínicas, hallazgos..." class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary-teal"></textarea>
                    </div>
                    
                    <!-- CAMBIO 3: Medicamentos Recetados -->
                    <div>
                        <label for="tratamiento-medicamentos" class="block text-gray-700 mb-1 font-semibold">Medicamentos Recetados (Opcional)</label>
                        <textarea id="tratamiento-medicamentos" rows="2" placeholder="Ej. Amoxicilina 500mg c/8h por 7 días..." class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary-teal"></textarea>
                    </div>

                </form>
            </div>

            <!-- Footer del Modal -->
            <div class="flex justify-end p-5 border-t space-x-4">
                <button id="btn-cancel-agregar-tratamiento" type="button" class="bg-white text-gray-700 border border-gray-300 font-semibold py-2 px-4 rounded-lg hover:bg-gray-50 transition duration-300">
                    Cancelar
                </button>
                <button type="submit" form="form-agregar-tratamiento" class="bg-secondary-teal text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-opacity-80 transition duration-300">
                    Guardar Tratamiento
                </button>
            </div>
        </div>
    </div>
    
    <!-- Modal 4: Filtros Avanzados (Idéntico al del Admin) -->
    <div id="modal-filtros-avanzados" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
        <!-- ... (Contenido del modal de filtros) ... -->
        <div class="bg-white rounded-2xl shadow-xl w-full max-w-lg">
            <div class="flex justify-between items-center p-5 border-b">
                <h3 class="text-xl font-bold text-primary-dark">Filtros Avanzados</h3>
                <button id="btn-close-filtros" class="text-gray-400 hover:text-gray-600">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            <div class="p-6">
                <form id="form-filtros-avanzados" class="space-y-4">
                    <div>
                        <label for="filtro-especie" class="block text-gray-700 mb-1 font-semibold">Filtrar por Especie</label>
                        <select id="filtro-especie" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary-teal">
                            <option value="todos">Todos</option>
                            <option value="Perro">Perro</option>
                            <option value="Gato">Gato</option>
                        </select>
                    </div>
                    <div>
                        <label for="filtro-alertas" class="block text-gray-700 mb-1 font-semibold">Filtrar por Alertas</label>
                        <select id="filtro-alertas" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary-teal">
                            <option value="todos">Todos</option>
                            <option value="con-alertas">Con Alertas</option>
                            <option value="sin-alertas">Sin Alertas</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="flex justify-end p-5 border-t space-x-4">
                <button id="btn-cancel-filtros" type="button" class="bg-white text-gray-700 border border-gray-300 font-semibold py-2 px-4 rounded-lg hover:bg-gray-50 transition duration-300">
                    Cancelar
                </button>
                <button type="submit" form="form-filtros-avanzados" class="bg-secondary-teal text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-opacity-80 transition duration-300">
                    Aplicar Filtros
                </button>
            </div>
        </div>
    </div>
    
    <!-- ¡MODAL NUEVO AniADIDO! -->
    <!-- Modal 5: Registrar Vacuna Aplicada (VERSIÓN VETERINARIO) -->
    <div id="modal-agregar-vacuna" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 hidden z-[70]"> <!-- z-70 para estar sobre el modal de detalle -->
        <!-- Contenedor del Modal -->
        <div class="bg-white rounded-2xl shadow-xl w-full max-w-lg">
            <!-- Header del Modal -->
            <div class="flex justify-between items-center p-5 border-b">
                <h3 class="text-xl font-bold text-primary-dark">Registrar Vacuna Aplicada</h3>
                <button id="btn-close-agregar-vacuna" class="text-gray-400 hover:text-gray-600">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            
            <!-- Cuerpo del Modal -->
            <div class="p-6">
                <form id="form-agregar-vacuna" class="space-y-4">
                    
                    <!-- CAMBIO: Veterinario Auto-asignado -->
                    <div class="p-3 bg-blue-50 border border-blue-200 rounded-lg">
                        <p class="text-sm font-semibold text-blue-800">
                            <strong>Veterinario que aplica:</strong> Dr. Israel Gonzalez (Tú)
                        </p>
                    </div>

                    <div>
                        <label for="vacuna-producto" class="block text-gray-700 mb-1 font-semibold">Vacuna (Producto del Inventario)</label>
                        <select id="vacuna-producto" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary-teal" required>
                            <option value="">Selecciona una vacuna del inventario...</option>
                            <option value="1">Vacuna Rabia DEFENSOR (10 en stock)</option>
                            <option value="2">Vacuna Múltiple PUPPY (5 en stock)</option>
                        </select>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="vacuna-fecha-aplicacion" class="block text-gray-700 mb-1 font-semibold">Fecha de Aplicación</label>
                            <input id="vacuna-fecha-aplicacion" type="date" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary-teal" required>
                        </div>
                        <div>
                            <label for="vacuna-fecha-proxima" class="block text-gray-700 mb-1 font-semibold">Próxima Dosis (Opcional)</label>
                            <input id="vacuna-fecha-proxima" type="date" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary-teal">
                        </div>
                    </div>

                </form>
            </div>

            <!-- Footer del Modal -->
            <div class="flex justify-end p-5 border-t space-x-4">
                <button id="btn-cancel-agregar-vacuna" type="button" class="bg-white text-gray-700 border border-gray-300 font-semibold py-2 px-4 rounded-lg hover:bg-gray-50 transition duration-300">
                    Cancelar
                </button>
                <button type="submit" form="form-agregar-vacuna" class="bg-secondary-teal text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-opacity-80 transition duration-300">
                    Registrar Vacuna
                </button>
            </div>
        </div>
    </div>


    <!-- Script para manejar los Modals -->
    <script>
        // --- Modal Helpers ---
        function openModal(modal) {
            if (modal) modal.classList.remove('hidden');
        }
        function closeModal(modal) {
            if (modal) modal.classList.add('hidden');
        }

        // --- Tabs del Modal Detalle ---
        const tabBtnInfo = document.getElementById('tab-btn-info');
        const tabBtnHistorial = document.getElementById('tab-btn-historial');
        const tabBtnVacunacion = document.getElementById('tab-btn-vacunacion'); 
        const tabBtnCitas = document.getElementById('tab-btn-citas'); 
        
        const tabContentInfo = document.getElementById('tab-content-info');
        const tabContentHistorial = document.getElementById('tab-content-historial');
        const tabContentVacunacion = document.getElementById('tab-content-vacunacion'); 
        const tabContentCitas = document.getElementById('tab-content-citas'); 

        // Array de todos los botones y contenidos de tabs
        const allTabBtns = [tabBtnInfo, tabBtnHistorial, tabBtnVacunacion, tabBtnCitas];
        const allTabContents = [tabContentInfo, tabContentHistorial, tabContentVacunacion, tabContentCitas];

        function handleTabClick(clickedBtn, activeContent) {
            // Desactivar todos
            allTabBtns.forEach(btn => {
                if(btn) btn.classList.remove('active');
            });
            allTabContents.forEach(content => {
                if(content) content.classList.remove('active');
                if(content) content.classList.add('hidden'); // Asegurarse de ocultar
            });
            
            // Activar el clickeado
            if (clickedBtn) clickedBtn.classList.add('active');
            if (activeContent) {
                activeContent.classList.add('active');
                activeContent.classList.remove('hidden');
            }
        }

        if (tabBtnInfo && tabContentInfo) {
            tabBtnInfo.addEventListener('click', () => handleTabClick(tabBtnInfo, tabContentInfo));
        }
        if (tabBtnHistorial && tabContentHistorial) {
            tabBtnHistorial.addEventListener('click', () => handleTabClick(tabBtnHistorial, tabContentHistorial));
        }
        if (tabBtnVacunacion && tabContentVacunacion) {
            tabBtnVacunacion.addEventListener('click', () => handleTabClick(tabBtnVacunacion, tabContentVacunacion));
        }
        if (tabBtnCitas && tabContentCitas) {
            tabBtnCitas.addEventListener('click', () => handleTabClick(tabBtnCitas, tabContentCitas));
        }


        // --- Modal 1: Agregar Mascota ---
        const btnAgregarMascota = document.getElementById('btn-agregar-mascota');
        const modalAgregarMascota = document.getElementById('modal-agregar-mascota');
        if (btnAgregarMascota && modalAgregarMascota) {
            const btnClose = document.getElementById('btn-close-agregar-mascota');
            const btnCancel = document.getElementById('btn-cancel-agregar-mascota');
            
            btnAgregarMascota.addEventListener('click', () => openModal(modalAgregarMascota));
            if(btnClose) btnClose.addEventListener('click', () => closeModal(modalAgregarMascota));
            if(btnCancel) btnCancel.addEventListener('click', () => closeModal(modalAgregarMascota));
        }

        // --- Modal 2: Detalle de Mascota ---
        const btnsDetalleMascota = document.querySelectorAll('.btn-detalle-mascota');
        const modalDetalleMascota = document.getElementById('modal-detalle-mascota');
        if (modalDetalleMascota && btnsDetalleMascota.length > 0) {
            const btnClose = document.getElementById('btn-close-detalle-mascota');
            
            btnsDetalleMascota.forEach(btn => {
                btn.addEventListener('click', () => {
                    // Aquí cargarías los datos de la mascota en el modal
                    if(tabBtnInfo) handleTabClick(tabBtnInfo, tabContentInfo); // Resetear a la primera pestania
                    openModal(modalDetalleMascota);
                });
            });
            if(btnClose) btnClose.addEventListener('click', () => closeModal(modalDetalleMascota));
        }

        // --- Modal 3: Agregar Tratamiento (anidado) ---
        const btnAgregarTratamiento = document.getElementById('btn-agregar-tratamiento');
        const modalAgregarTratamiento = document.getElementById('modal-agregar-tratamiento');
        if (btnAgregarTratamiento && modalAgregarTratamiento) {
            const btnClose = document.getElementById('btn-close-agregar-tratamiento');
            const btnCancel = document.getElementById('btn-cancel-agregar-tratamiento');

            btnAgregarTratamiento.addEventListener('click', () => openModal(modalAgregarTratamiento));
            if(btnClose) btnClose.addEventListener('click', () => closeModal(modalAgregarTratamiento));
            if(btnCancel) btnCancel.addEventListener('click', () => closeModal(modalAgregarTratamiento));
        }

        // --- Modal 4: Filtros Avanzados ---
        const btnFiltros = document.getElementById('btn-filtros-avanzados');
        const modalFiltros = document.getElementById('modal-filtros-avanzados');

        if(btnFiltros && modalFiltros) {
            const btnCloseFiltros = document.getElementById('btn-close-filtros');
            const btnCancelFiltros = document.getElementById('btn-cancel-filtros');

            btnFiltros.addEventListener('click', () => openModal(modalFiltros));
            if (btnCloseFiltros) btnCloseFiltros.addEventListener('click', () => closeModal(modalFiltros));
            if (btnCancelFiltros) btnCancelFiltros.addEventListener('click', () => closeModal(modalFiltros));
        }
        
        // --- ¡NUEVO! Modal 5: Registrar Vacuna (anidado) ---
        const btnAgregarVacuna = document.getElementById('btn-agregar-vacuna');
        const modalAgregarVacuna = document.getElementById('modal-agregar-vacuna');
        if (btnAgregarVacuna && modalAgregarVacuna) {
            const btnClose = document.getElementById('btn-close-agregar-vacuna');
            const btnCancel = document.getElementById('btn-cancel-agregar-vacuna');

            btnAgregarVacuna.addEventListener('click', () => openModal(modalAgregarVacuna));
            if(btnClose) btnClose.addEventListener('click', () => closeModal(modalAgregarVacuna));
            if(btnCancel) btnCancel.addEventListener('click', () => closeModal(modalAgregarVacuna));
        }

    </script>

